<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bank Details - Battery Testing</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container navbar-container">
            <a href="index.html" class="navbar-brand">Battery Testing</a>
            <ul class="navbar-nav">
                <li><a href="index.html" class="nav-link">Dashboard</a></li>
                <li><a href="setup.html" class="nav-link">Create New Test</a></li>
            </ul>
        </div>
    </nav>

    <!-- Breadcrumb Navigation -->
    <div class="container mt-4">
        <div class="breadcrumb">
            <a href="index.html">Dashboard</a> &gt; 
            <span id="testBreadcrumb">Test Details</span> &gt; 
            <span id="bankBreadcrumb">Bank Details</span>
        </div>
    </div>

    <!-- Header -->
    <header class="page-header">
        <div class="container">
            <div class="d-flex justify-between align-center">
                <div>
                    <h1 class="page-title">Bank <span id="bankNumber"></span></h1>
                    <p class="page-subtitle">Job #<span id="jobNumber"></span> - <span id="customerName"></span></p>
                </div>
                <div class="status-badge" id="testStatus">Status</div>
            </div>
        </div>
    </header>

    <main class="container">
        <!-- Alert area for notifications -->
        <div id="alertContainer" class="mb-4"></div>

        <!-- Bank Information Card -->
        <div class="card mb-4">
            <div class="card-header">
                <h3 class="card-title">Bank Information</h3>
            </div>
            <div class="card-body">
                <div class="grid grid-cols-2">
                    <div>
                        <div class="info-row">
                            <span class="info-label">Cell Type:</span>
                            <span class="info-value" id="cellType"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Cell Rate:</span>
                            <span class="info-value" id="cellRate"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Percentage Capacity:</span>
                            <span class="info-value" id="percentageCapacity"></span>%
                        </div>
                    </div>
                    <div>
                        <div class="info-row">
                            <span class="info-label">Discharge Current:</span>
                            <span class="info-value" id="dischargeCurrent"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Number of Cells:</span>
                            <span class="info-value" id="numberOfCells"></span>
                        </div>
                        <div class="info-row">
                            <span class="info-label">Start Date:</span>
                            <span class="info-value" id="startDate"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-footer">
                <div class="d-flex justify-between align-center">
                    <div>
                        <span class="info-label">Test Progress:</span>
                        <div class="progress-container mt-1" style="width: 200px;">
                            <div class="progress-bar" id="progressBar" style="width: 0%;"></div>
                        </div>
                        <div class="progress-label" id="progressLabel">0% Complete</div>
                    </div>
                    <button class="btn btn-primary" id="exportBtn">Export Data</button>
                </div>
            </div>
        </div>

        <!-- Cycles List -->
        <div class="card mb-4">
            <div class="card-header">
                <h3 class="card-title">Cycles</h3>
            </div>
            <div class="card-body">
                <div id="cyclesList" class="cycles-list">
                    <!-- Cycles will be loaded here dynamically -->
                    <div class="loader-container" id="loaderContainer">
                        <div class="loader"></div>
                    </div>
                    <div class="empty-state hidden" id="emptyState">
                        <div class="empty-state-message">No cycles found for this bank</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Templates -->
    <template id="cycleItemTemplate">
        <div class="cycle-item">
            <div class="cycle-header">
                <h4 class="cycle-title">Cycle <span data-field="cycle_number"></span></h4>
                <span class="cycle-status" data-field="status"></span>
            </div>
            <div class="cycle-details">
                <div class="cycle-info">
                    <div class="info-row">
                        <span class="info-label">Start Time:</span>
                        <span class="info-value" data-field="start_time"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">End Time:</span>
                        <span class="info-value" data-field="end_time"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">Duration:</span>
                        <span class="info-value" data-field="duration"></span>
                    </div>
                </div>
                <div class="cycle-actions">
                    <a href="#" class="btn btn-primary view-cycle-btn" data-field="view-cycle-btn">View Readings</a>
                </div>
            </div>
        </div>
    </template>

    <template id="alertTemplate">
        <div class="alert">
            <span data-field="message"></span>
        </div>
    </template>

    <!-- Scripts -->
    <script type="module" src="js/api.js"></script>
    <script type="module" src="js/bank-view.js"></script>
</body>
</html>